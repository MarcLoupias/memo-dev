(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{348:function(e,t,s){"use strict";s.r(t);var a=s(33),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"angular-migration-from-angularjs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#angular-migration-from-angularjs"}},[e._v("#")]),e._v(" Angular - Migration from AngularJS")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://angular.io/guide/upgrade",target:"_blank",rel:"noopener noreferrer"}},[e._v("Upgrade guide ng2 doc"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.codeproject.com/Articles/1121384/AngularJS-Migration-Guide",target:"_blank",rel:"noopener noreferrer"}},[e._v("AngularJS 2.0 Migration Guide : codeproject.com"),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("p",[e._v("2016/08/31")]),e._v(" "),s("p",[s("strong",[e._v("Preparation")])]),e._v(" "),s("ul",[s("li",[e._v("Follow the John Papa’s Styleguide for Angular 1 development")]),e._v(" "),s("li",[e._v("Update to the latest version of Angular 1")]),e._v(" "),s("li",[e._v("All new development using components")]),e._v(" "),s("li",[e._v("Switch controllers to components (component directives)")]),e._v(" "),s("li",[e._v("Remove incompatible features (specific to Angular 2) from directives")]),e._v(" "),s("li",[e._v("Implement manual bootstrapping (No more ng-app)")])]),e._v(" "),s("p",[s("strong",[e._v("Upgrade")])]),e._v(" "),s("ul",[s("li",[e._v("Add TypeScript transpilation and build")]),e._v(" "),s("li",[e._v("Start using ES6 or JavaScript 2015")]),e._v(" "),s("li",[e._v("Switch controllers and services to ES6 Classes")]),e._v(" "),s("li",[e._v("Add Angular 2.0 to your project")]),e._v(" "),s("li",[e._v("Migrate one piece at a time")])])]),e._v(" "),s("p",[s("a",{attrs:{href:"http://maxlab.fr/javascript/migrer-de-angularjs-1-x-vers-angularjs-2-0-pratique/#foot_loc_1403_1",target:"_blank",rel:"noopener noreferrer"}},[e._v("Préparer la migration de AngularJS 1.x vers AngularJS 2.0 : maxlab.fr"),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("p",[e._v("Eviter l’usage de "),s("code",[e._v("$scope")]),e._v(" et utiliser la syntaxe "),s("code",[e._v("ControllerAs")]),e._v(".")]),e._v(" "),s("p",[e._v("Supprimer le "),s("code",[e._v("$scope")]),e._v(", c’est supprimer "),s("code",[e._v("$watch")]),e._v(" "),s("code",[e._v("$apply")]),e._v(" "),s("code",[e._v("$timeout")]),e._v(" .. des notions qui compliquent l’apprentissage du\nframework et sont souvent à l’origine de "),s("a",{attrs:{href:"http://www.bennadel.com/blog/2605-scope-evalasync-vs-timeout-in-angularjs.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("hacks"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Au lieu de créer un controleur et d’utiliser "),s("code",[e._v("ng-controller")]),e._v(", préférez l’usage d’une directive.")]),e._v(" "),s("p",[e._v("Tirer profit des fonctionnalités d’ECMAscript 6/2015")]),e._v(" "),s("ul",[s("li",[e._v("Les "),s("a",{attrs:{href:"https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Instructions/import",target:"_blank",rel:"noopener noreferrer"}},[e._v("modules"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("pour appliquer le paragraphe précédent sur le découplage")]),e._v(" "),s("ul",[s("li",[e._v("Les "),s("a",{attrs:{href:"https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Fonctions/Fonctions_fl%C3%A9ch%C3%A9es",target:"_blank",rel:"noopener noreferrer"}},[e._v("arrow functions"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("pour simplifier les retours issues de promises, l’utilisation des fonctions sur les tableaux et le binding du "),s("code",[e._v("this")])]),e._v(" "),s("ul",[s("li",[e._v("La "),s("a",{attrs:{href:"http://ariya.ofilabs.com/2013/02/es6-and-object-literal-property-value-shorthand.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("notation objet simplifiée"),s("OutboundLink")],1),e._v(" et la "),s("a",{attrs:{href:"https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Op%C3%A9rateurs/Affecter_par_d%C3%A9composition",target:"_blank",rel:"noopener noreferrer"}},[e._v("décomposition"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("pour réduire le code et augmenter la lisibilité")]),e._v(" "),s("ul",[s("li",[e._v("Les classes : pour coller à la syntaxe d’Angular 2 et éventuellement utiliser les "),s("a",{attrs:{href:"https://github.com/wycats/javascript-decorators",target:"_blank",rel:"noopener noreferrer"}},[e._v("décorateurs d’ES7"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("Services : Dans Angular 2, les services sont de simples classes, il est préférable de n’utiliser que "),s("code",[e._v("angular.service")]),e._v("\ndans Angular 1")])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.inrhythm.com/upgrading-angular-1-to-react-angular-2/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Preparing your Angular 1 codebase to upgrade to React or Angular 2 - www.inrhythm.com - 20170424"),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[e._v("Step 1: Integrate Webpack into your build process")]),e._v(" "),s("ul",[s("li",[e._v("use index.js files in each dir/subdir to build a tree of files (all files : js, css and html)")]),e._v(" "),s("li",[e._v("drop gulp in favor of Webpack")])])]),e._v(" "),s("li",[s("p",[e._v("Step 2: Embrace ES6 modules, upgrade Angular services and controllers to ES6 classes")]),e._v(" "),s("ul",[s("li",[e._v("replace global objects through IIFE with ES6 imports")]),e._v(" "),s("li",[e._v("refactor old functions definitions for components and services with classes")])])]),e._v(" "),s("li",[s("p",[e._v("Step 3: Abstract away the Angular module system and decouple your source code from the framework")]),e._v(" "),s("ul",[s("li",[e._v("replace angular builtin helpers functions with lodash functions")]),e._v(" "),s("li",[e._v("use the ui-router pattern (a single ngModule for all the app, and use the regular ES6 modules)")])])])])]),e._v(" "),s("h2",{attrs:{id:"retex-step-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retex-step-1"}},[e._v("#")]),e._v(" RETEX Step 1")]),e._v(" "),s("p",[e._v("Fonctionne très bien mais pas facile :")]),e._v(" "),s("ul",[s("li",[e._v("attention à l'ordre des "),s("code",[e._v("import")]),e._v(" dans les fichiers "),s("code",[e._v("index.js")]),e._v(", placer les déclarations de modules en premier dans chaque fichier")]),e._v(" "),s("li",[e._v("si usage de Bootstrap, il suppose la présence de l'objet "),s("code",[e._v("jQuery")]),e._v(" sur l'objet "),s("code",[e._v("window")]),e._v(", il convient donc de l'ajouter :")])]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// webpack conf")]),e._v("\n\n    plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("webpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ProvidePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            $"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'jquery'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            jQuery"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'jquery'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'window.jQuery'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'jquery'")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br")])]),s("ul",[s("li",[e._v("il est possible que certaines dépendances soient chargées plusieurs fois selon comment elles sont organisées. Par exemple d'avoir ce message de AngularJS "),s("code",[e._v("WARNING: Tried to load angular more than once.")]),e._v(". Ca augmente la taille du bundle mais comme c'est temporaire on peut passer outre le temps de tout passer en modules ES6.")]),e._v(" "),s("li",[e._v("problème avec les variables globales (par ex fichier de config). Dans un premier temps, coller ces variables dans l'objet global "),s("code",[e._v("window")]),e._v(" ("),s("a",{attrs:{href:"https://stackoverflow.com/questions/37656592/define-global-variable-with-webpack",target:"_blank",rel:"noopener noreferrer"}},[e._v("cf"),s("OutboundLink")],1),e._v("). Attention à l'ordre des imports comme pour les modules AngularJS.")]),e._v(" "),s("li",[e._v("problème avec les dépendances importées via l'IIFE en tant que variables globales. Passer directement par un import classique depuis le source concerné en plus de l'IIFE. Par ex : "),s("code",[e._v("import Fuse from '../../../../node_modules/fuse.js/dist/fuse.min';")]),e._v(" à ajouter en tête de fichier devant l'IIFE qui n'est pas touchée.")]),e._v(" "),s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/33300289/how-to-use-webpack-with-angular-templatecache",target:"_blank",rel:"noopener noreferrer"}},[e._v("problème avec les templates des composants"),s("OutboundLink")],1),e._v(". La solution la plus simple est de ne pas importer les html via les "),s("code",[e._v("index.js")]),e._v(" mais direct via les composants en faisant un "),s("code",[e._v("require")]),e._v(" du fichier html sur la props "),s("code",[e._v("template")]),e._v(" plutôt que via "),s("code",[e._v("templateUrl")]),e._v(".")]),e._v(" "),s("li",[e._v("problème avec les css. Attention depuis le browser les urls des css sont résolvées avec le chemin relatif serveur de la css. Par exemple, si sur le serveur web j'ai "),s("code",[e._v("/assets/css/app.css")]),e._v(" et que dans cette css j'ai une instruction "),s("code",[e._v("url()")]),e._v(" qui pointe sur "),s("code",[e._v("/assets/fonts/toto.woff")]),e._v(" par exemple, lorsque le call sera effectué dans le browser ça ira chercher sur "),s("code",[e._v("/assets/css/assets/fonts/toto.woff")]),e._v(". Il convient donc de placer les css à la racine du serveur web pour éviter ce problème.")]),e._v(" "),s("li",[e._v("problème dans certains templates : Il faut être très strict sur la présentation de caractères spéciaux dans les templates, il ne faut par exemple aucun opérateur logique webpack aime pas !")])]),e._v(" "),s("h2",{attrs:{id:"retex-step-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retex-step-2"}},[e._v("#")]),e._v(" RETEX Step 2")]),e._v(" "),s("p",[e._v("Dans les grandes lignes :")]),e._v(" "),s("ul",[s("li",[e._v("utiliser les "),s("code",[e._v("import")]),e._v("/"),s("code",[e._v("export")]),e._v(" ES6")]),e._v(" "),s("li",[e._v("supprimer toutes les IIFE")]),e._v(" "),s("li",[e._v("passer du style-guide de John Papa qui est calibré sur AngularJS avec ES5 à "),s("a",{attrs:{href:"https://github.com/toddmotto/angularjs-styleguide",target:"_blank",rel:"noopener noreferrer"}},[e._v("celui de Todd Motto"),s("OutboundLink")],1),e._v(" qui est calibré pour ES2015.")])]),e._v(" "),s("p",[e._v("concrètement :")]),e._v(" "),s("ul",[s("li",[e._v("supprimer les IIFE, exporter l'objet/fonction de description du component/filter/service/directive")]),e._v(" "),s("li",[e._v("renommer la fonction de déclaration de "),s("code",[e._v("blablaService")]),e._v(" en "),s("code",[e._v("blabla")]),e._v(", exporter en nommant le type de composant (Component, Filter, Service, Directive).")])]),e._v(" "),s("p",[e._v("Par exemple pour un composant référencé "),s("code",[e._v("'headerView'")]),e._v(" dans l'injecteur ayant un contrôleur "),s("code",[e._v("HeaderViewController")]),e._v(" :")]),e._v(" "),s("p",[e._v("Avant on a")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// header-view.component.js")]),e._v("\n    angular\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("module")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'app.header'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'headerView'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            template"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./header-view.html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            controller"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" HeaderViewController\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("Après on a :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// header-view.component.js")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" HeaderViewComponent "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    template"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./header-view.html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    controller"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" HeaderViewController\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// puis la déclaration des injections de HeaderViewController")]),e._v("\nHeaderViewController"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("$inject "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("/* ... */")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// puis l'implémentation du ctrl")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("HeaderViewController")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("/* ... */")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("var")]),e._v(" ctrl "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br")])]),s("ul",[s("li",[e._v("importer dans la déclaration du module afférant")])]),e._v(" "),s("p",[e._v("Dans le fichier "),s("code",[e._v("*.module.js")]),e._v(" correspondant c'est là qu'on va désormais déclarer les composants à l'injecteur.")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// header.module.js")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" angular "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'angular'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("HeaderViewComponent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./header-view.component'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" header "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" angular"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("module")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'app.header'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\nheader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'headerView'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" HeaderViewComponent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// on exporte le module pour l'importer à son tour dans le module de niveau supérieur")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" HeaderModule "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" header"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Attention le module qui importe ce module doit set le nom en dépendant et pas le module lui même :")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// app.module.js")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" angular "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'angular'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("HeaderModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./layout/header/header.module'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//...")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" angular"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("module")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'app'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("HeaderModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br")])]),s("ul",[s("li",[e._v("supprimer les fichiers "),s("code",[e._v("index.js")]),e._v(" dont les "),s("code",[e._v("import")]),e._v(" font doublons")]),e._v(" "),s("li",[e._v("garder les "),s("code",[e._v("index.js")]),e._v(" pour les dépendances et le point d'entrée de l'appli")]),e._v(" "),s("li",[e._v("reconfigurer ESLint pour prendre en charge ES2015 et les modules")])]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"parserOptions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"ecmaVersion"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"sourceType"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"module"')]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("ul",[s("li",[e._v("après cette migration, "),s("strong",[e._v("Karma n'est plus capable d'exécuter les TU out-of-the-box")]),e._v(". Les remettre d'aplomb n'est pas utile puisqu'il n'y aura aucun dev et que Cypress permet de tester la non-régression (suppose d'avoir des tests d'UI suffisamment fiables, Cypress est parfait pour ça !).")]),e._v(" "),s("li",[e._v("refacto les composants / services / controller / etc ... en classes.")])]),e._v(" "),s("p",[e._v("composants :")]),e._v(" "),s("p",[e._v("La fonction déclarant le controller devient une classe.\nOn ajoute un constructeur à cette classe pour réaliser les injections de dépendances :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("    "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("constructor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" headerMenuConfigObjectService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" headerService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("logger "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("headerMenuConfigObjectService "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" headerMenuConfigObjectService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("headerService "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" headerService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("On binde les services à l'instance. Le "),s("code",[e._v("var ctrl = this;")]),e._v(" disparait.")]),e._v(" "),s("p",[e._v("Les fonctions implémentants les events hooks :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("    ctrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("$onInit")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'app.header.HeaderViewController.$onInit()'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'start'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        ctrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("grandMenu "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" headerMenuConfigObjectService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("getMenu")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        ctrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("stats "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" headerService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        ctrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("clickRefreshData "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" headerService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("clickRefreshData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'app.header.HeaderViewController.$onInit() ctrl.grandMenu = '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" ctrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("grandMenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("deviennent des fonctions de la classe :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("    "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("$onInit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'app.header.HeaderView.$onInit()'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'start'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//this.grandMenu = this.headerMenuConfigObjectService.getMenu(); // inutile puisque headerMenuConfigObjectService est bind au moment de son injection")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("stats "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("headerService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//this.clickRefreshData = this.headerService.clickRefreshData; // inutile puisque headerService est bind au moment de son injection")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'app.header.HeaderView.$onInit() ctrl.grandMenu = '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("grandMenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("en l'absence de ngAnnotate, la déclaration des dépendances à injecter doit être conservée :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("HeaderView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("$inject "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'logger'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'headerMenuConfigObjectService'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'headerService'")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("On se retrouve avec 3 blocs :")]),e._v(" "),s("ul",[s("li",[e._v("l'export de la déclaration du composant (un litteral) qui deviendra un decorator en Angular.")]),e._v(" "),s("li",[e._v("la classe implémentant le comportement du composant (l'ancien controller)")]),e._v(" "),s("li",[e._v("la déclaration explicite des dépendances à injecter")])]),e._v(" "),s("p",[e._v("Attention la classe doit être impérativement déclarée en premier. Il faut donc déplacer les blocs pour avoir la classe en premier, ensuite les injections et enfin l'export.")]),e._v(" "),s("p",[e._v("Attention il faut transformer les fonctions anonymes des résolutions de promesses dans les composants par des arrows functions (à cause du "),s("code",[e._v("this")]),e._v(")")]),e._v(" "),s("p",[e._v("Attention avec les services, lorsqu'on a défini l'implémentation de higher order function ("),s("code",[e._v("reduce")]),e._v(", "),s("code",[e._v("map")]),e._v(", "),s("code",[e._v("filter")]),e._v(") dans une fonction du service/directive et qu'on la passait telle quelle (la définition de la fonction sans l'exécuter), maintenant que ces fonctions sont des méthodes de fonctions il est nécessaire d'avoir une exécution.")]),e._v(" "),s("p",[e._v("On ne peut plus faire :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("selectedTagList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("mapTagListToTagListName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("où "),s("code",[e._v("mapTagListToTagListName")]),e._v(" serait une méthode de la même classe telle que :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("    "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mapTagListToTagListName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("item")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("on doit exécuter la méthode :")]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("selectedTagList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mapTagListToTagListName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("et donc retourner la fonction implémentant la "),s("code",[e._v("map")])]),e._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("    "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mapTagListToTagListName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("item")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[s("a",{attrs:{href:"http://blogtech.soprasteria.com/2017/05/24/quelques-grands-principes-pour-aller-vers-angular-2-x-en-venant-dangular-1-4/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Quelques grands principes pour aller vers Angular 2.x en venant d’Angular 1.4 ? : blogtech.soprasteria.com"),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("p",[e._v("Très détaillé avec contextualisation + plein de bons liens en fin d'article")])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://blog.xebia.fr/2016/03/01/webpack-es6-es2015-babel-6-pour-modulariser-son-application-angularjs/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Webpack, ES6 (ES2015) & Babel 6 pour modulariser son application AngularJS - blog.xebia.fr - 20160301"),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("p",[e._v("montre un exemple possible d'état intermédiaire (ES2015 + Babel + Webpack) lors de la migration quand on part d'un AngularJS legacy (par ex ng1.4 + ES5 + grunt/gulp).")])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/Gillespie59/angular2-migration-sample",target:"_blank",rel:"noopener noreferrer"}},[e._v("Gillespie59/angular2-migration-sample : "),s("code",[e._v("github.com")]),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("p",[e._v("a short example")])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/ngmigrate/ngmigrate.github.io",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("ngmigrate/ngmigrate.github.io")]),e._v(" : "),s("code",[e._v("github.com")]),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("p",[e._v("source code of the Todd Motto migration guide "),s("a",{attrs:{href:"http://developer.telerik.com/angular-2-migration-guide/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ng-migrate"),s("OutboundLink")],1)])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/ngParty/ng1-migration-workshop",target:"_blank",rel:"noopener noreferrer"}},[e._v("ngParty/ng1-migration-workshop : "),s("code",[e._v("github.com")]),s("OutboundLink")],1)]),e._v(" "),s("blockquote",[s("p",[e._v("migration example app from angular 1.x ES5 to Typescript and ngMetadata")])]),e._v(" "),s("p",[s("a",{attrs:{href:"http://blog.rangle.io/upgrade-your-application-to-angular-2-with-ng-upgrade/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Upgrading Your Application to Angular 2 with ng-upgrade : blog.rangle.io"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://blog.thoughtram.io/angular/2015/10/24/upgrading-apps-to-angular-2-using-ngupgrade.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Upgrading Angular apps using ngUpgrade - Pascal Precht - 20161218"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://blog.nrwl.io/ngupgrade-in-depth-436a52298a00",target:"_blank",rel:"noopener noreferrer"}},[e._v("NgUpgrade in Depth - Victor Savkin - 20170512"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"migration-des-watch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#migration-des-watch"}},[e._v("#")]),e._v(" migration des "),s("code",[e._v("$watch")])]),e._v(" "),s("ul",[s("li",[e._v("soit on a un ng-model auquel cas il suffit d'ajouter un ng-change")]),e._v(" "),s("li",[e._v("soit on a besoin de AngularJS 1.5 et d'utiliser le life cycle event "),s("code",[e._v("$onChanges")]),e._v(" des composants")])]),e._v(" "),s("p",[e._v("L'idée avec les life cycles event c'est de remplacer le dirty checking d'origine placé sur tout l'arbre des scopes par un cycle de vie centré composant par composant.")]),e._v(" "),s("h2",{attrs:{id:"migration-ui-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#migration-ui-router"}},[e._v("#")]),e._v(" migration ui-router")]),e._v(" "),s("p",[e._v("To upgrade ui-router 0.4.x to 1.0.x, we need to use a bundler and modules.")]),e._v(" "),s("p",[e._v("Check full example at "),s("a",{attrs:{href:"https://github.com/ui-router/sample-app-angularjs",target:"_blank",rel:"noopener noreferrer"}},[e._v("sample-app-angularjs - "),s("code",[e._v("github.com/ui-router")]),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("If you don't want to migrate from IIFE to ES6 modules and a bundlers (you want to upgrade ui-router first before the bundlers and ES6 modules), you can import a mono-bundle backward compatible, cf "),s("a",{attrs:{href:"https://ui-router.github.io/blog/uirouter-for-angularjs-umd-bundles/",target:"_blank",rel:"noopener noreferrer"}},[e._v("\nUirouter For Angularjs Umd Bundles\n"),s("OutboundLink")],1),e._v(" post.")]),e._v(" "),s("p",[e._v("Using "),s("code",[e._v('<script src="../node_modules/@uirouter/angularjs/release/angular-ui-router.min.js"><\/script>')]),e._v(" works well in an ES5 / AngularJS 1.6+ code base with "),s("code",[e._v("@uirouter/angularjs@1.0.17")]),e._v(".")]),e._v(" "),s("p",[e._v("The main breaking change is the removal of "),s("code",[e._v("$rootScope")]),e._v(" events replaced by "),s("code",[e._v("$transitions")]),e._v(" services hooks.")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("$stateParams")]),e._v(" service becomes "),s("strong",[e._v("deprecated")]),e._v(". The best way to deal with it "),s("a",{attrs:{href:"https://github.com/angular-ui/ui-router/issues/3110#issuecomment-315855728",target:"_blank",rel:"noopener noreferrer"}},[e._v("is explained here"),s("OutboundLink")],1),e._v(" :")]),e._v(" "),s("p",[e._v("Inject "),s("code",[e._v("$uiRouterGlobals")]),e._v(" and use its attribute "),s("code",[e._v("params [Object]")]),e._v(" like this: "),s("code",[e._v("$uiRouterGlobals.params.myParam")])])])}),[],!1,null,null,null);t.default=n.exports}}]);