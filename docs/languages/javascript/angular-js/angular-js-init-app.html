<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui"><meta name="robots" content="none"><title>marlou knowledge base</title><link href="/github-markdown.7d1fca7c.css" rel="stylesheet" media="all"><link href="/main.4b9cca7f.css" rel="stylesheet" media="all"><link href="/github.8c766760.css" rel="stylesheet"><script src="/docs.39594acf.js"></script></head><body><article class="markdown-body"><h1 id="title-angularjs---app-init">AngularJS - app init</h1>
<h2 id="title-bootstrap-dune-app-web">Bootstrap d’une app web</h2>
<ol>
<li><p>Le browser lève l’event [DOMContentLoaded] (<a href="https://developer.mozilla.org/en-US/docs/Web/Reference/Events/DOMContentLoaded">https://developer.mozilla.org/en-US/docs/Web/Reference/Events/DOMContentLoaded</a> ) durant ce step.<br>Le moment exact est aléatoire, il n’attend pas le chargement des ressources liées à la page (css et images), le html et les js associés sont chargés cependant, on passe direct au point 3, le point 2 se joue en parallèle.</p>
</li>
<li><p>Le browser lève l’event [load] (<a href="https://developer.mozilla.org/en-US/docs/Web/Reference/Events/load">https://developer.mozilla.org/en-US/docs/Web/Reference/Events/load</a>) en fin de step.<br>Toutes les dépendances (de la page d’index) ont été téléchargées (non bloquant pour le démarrage angular).</p>
</li>
<li><p>Démarrage Angular</p>
<ol>
<li><p>la méthode <code>angularInit(element, bootstrap)</code> est exécutée.<br>Elle cherche la directive <code>ng-app</code> et son paramètre (le module racine de l’application).</p>
</li>
<li><p>la méthode <code>bootstrap(element, bootstrap)</code> est exécutée.<br>Elle détermine si le bootstrap de l’app doit se faire maintenant ou si il est délayé.<br>Si il n’est pas délayé elle crée l’injecteur via <code>createInjector(modulesToLoad, strictDi)</code></p>
</li>
<li><p>création de l’injecteur via <code>createInjector(modulesToLoad, strictDi)</code><br>Tous les modules angular et leurs sous modules (modules optionnels comme ngLocale) sont chargés.<br>Un cache des composants est créé (les services sont des singletons, s’ils ne sont pas instanciés ils le sont et sont ajoutés au cache, à chaque nouvel appel le cache est vérifié et si angular trouve quelque chose il sert l’élément présent dans le cache et ne fait pas de nouvelle instanciation).<br>Viennent ensuite toutes les dépendances déclarées sur le module principal.<br>Durant cette phase tout l’arbre des dépendance est parsé.<br>Une liste des <code>config()</code> à exécuter est constituée ainsi qu’une liste de <code>run()</code><br>Les <code>config()</code> de tous les modules sont ensuite exécutés dans l’ordre inverse de l’arbre.<br>Seuls les services de type <code>provider</code> et <code>constant</code> peuvent être injectés.<br>puis<br><code>run()</code> de tous les modules dans le même ordre que pour <code>config()</code><br>Les <code>provider</code> sont interdits à ce stade (pas de config de <code>provider</code> au runtime.</p>
</li>
<li><p>L’injecteur a été créé. Tous les modules ont joué leur <code>config()</code> puis leur <code>run()</code> en terminant par celui du module principal de l’app.<br>L’injecteur crée le <code>$rootScope</code> puis compile l’app sur la base de <code>ng-app</code> qui sert de racine.<br>Si une directive <code>ng-controller</code> est rencontrée, l’injecteur est appelé pour instancier le controller associé.</p>
</li>
<li><p>La webapp est rendue, elle attend une interaction de l’utilisateur.</p>
</li>
</ol>
</li>
</ol>
<h3 id="title-exemple-ordre-dexécution-des-modules-au-bootstrap">Exemple ordre d’exécution des modules au bootstrap</h3>
<p>Ex, on a la hiérarchie suivante :</p>
<pre><code>app
app.moduleA
app.moduleA.subModuleA1
app.moduleB</code></pre><p>l’ordre d’exécution sera :</p>
<pre><code>app.moduleB
app.moduleA.subModuleA1
app.moduleA
app</code></pre><p>ou</p>
<pre><code>app.moduleA.subModuleA1
app.moduleA
app.moduleB
app</code></pre><p>mais jamais </p>
<pre><code>app.moduleA
app.moduleA.subModuleA1
app.moduleB
app</code></pre><h3 id="title-documentation-à-check-">Documentation à check :</h3>
<ul>
<li>[ng dev guide - module] (<a href="https://docs.angularjs.org/guide/module">https://docs.angularjs.org/guide/module</a>)</li>
<li>[ng dev guide - bootstrap] (<a href="https://docs.angularjs.org/guide/bootstrap">https://docs.angularjs.org/guide/bootstrap</a>)</li>
<li>[ng dev guide - dependency injection] (<a href="https://docs.angularjs.org/guide/di">https://docs.angularjs.org/guide/di</a>)</li>
<li>[angular.module] (<a href="https://docs.angularjs.org/api/ng/function/angular.module">https://docs.angularjs.org/api/ng/function/angular.module</a>)</li>
<li>[angular.injector] (<a href="https://docs.angularjs.org/api/ng/function/angular.injector">https://docs.angularjs.org/api/ng/function/angular.injector</a>)</li>
<li>[ngApp] (<a href="https://docs.angularjs.org/api/ng/directive/ngApp">https://docs.angularjs.org/api/ng/directive/ngApp</a>)</li>
<li>[ngView] (<a href="https://docs.angularjs.org/api/ngRoute/directive/ngView">https://docs.angularjs.org/api/ngRoute/directive/ngView</a>)</li>
<li>[$injector] (<a href="https://docs.angularjs.org/api/auto/service/$injector">https://docs.angularjs.org/api/auto/service/$injector</a>)</li>
<li>[$provide] (<a href="https://docs.angularjs.org/api/auto/service/$provide">https://docs.angularjs.org/api/auto/service/$provide</a>)</li>
<li>[$location] (<a href="https://docs.angularjs.org/api/ng/service/$location">https://docs.angularjs.org/api/ng/service/$location</a>)</li>
</ul>
<h2 id="title-knowing-when-the-a-view-has-finished-loading">knowing when the a view has finished loading</h2>
<p>[not possible because of MVVM pattern] (<a href="http://stackoverflow.com/questions/14368097/execute-function-after-page-has-finished-downloading-and-bootstrapping">http://stackoverflow.com/questions/14368097/execute-function-after-page-has-finished-downloading-and-bootstrapping</a>)</p>
<h2 id="title-others-topics">others topics</h2>
<ul>
<li>[Misko Hevery comment on an angular github issue] (<a href="https://github.com/angular/angular.js/issues/1306#issuecomment-8200414">https://github.com/angular/angular.js/issues/1306#issuecomment-8200414</a>)</li>
<li>[is there a post render callback for angular directive] (<a href="http://stackoverflow.com/questions/11125078/is-there-a-post-render-callback-for-angular-js-directive">http://stackoverflow.com/questions/11125078/is-there-a-post-render-callback-for-angular-js-directive</a>)</li>
<li>[how to invoke a function in an angular directive after the child nodes have been processed] (<a href="http://stackoverflow.com/questions/15932771/how-to-invoke-a-function-in-an-angular-directive-after-the-child-nodes-have-been/15946913#15946913">http://stackoverflow.com/questions/15932771/how-to-invoke-a-function-in-an-angular-directive-after-the-child-nodes-have-been/15946913#15946913</a>)</li>
<li>[What is meant by Bootstrapping in angular JS?] (<a href="http://stackoverflow.com/questions/21058213/what-is-meant-by-bootstrapping-in-angular-js">http://stackoverflow.com/questions/21058213/what-is-meant-by-bootstrapping-in-angular-js</a>)</li>
<li>[sending event when angular finished loading] (<a href="http://stackoverflow.com/questions/14968690/sending-event-when-angular-js-finished-loading">http://stackoverflow.com/questions/14968690/sending-event-when-angular-js-finished-loading</a>)</li>
<li>[les fondations de AngularJS] (<a href="http://blog.xebia.fr/2013/10/14/les-fondations-dangularjs/">http://blog.xebia.fr/2013/10/14/les-fondations-dangularjs/</a>)</li>
</ul>
</article></body></html>