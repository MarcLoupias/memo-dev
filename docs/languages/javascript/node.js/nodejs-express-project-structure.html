<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui"><meta name="robots" content="none"><title>marlou knowledge base</title><link href="github-markdown.d098492d.css" rel="stylesheet" media="all"><link href="main.cb64a04a.css" rel="stylesheet" media="all"><link href="github.51c27d45.css" rel="stylesheet"><script src="docs.a0c71561.js"></script></head><body><article class="markdown-body"><h1 id="title-nodejs---express-project-structure">nodejs - express project structure</h1> <h2 id="title-express-internals">express internals</h2> <p><a href="https://www.sohamkamani.com/blog/2018/05/30/understanding-how-expressjs-workhtml">How express.js works - Understanding the internals of the express library - www.sohamkamani.com/blog - 20180530</a></p> <h2 id="title-project-pov">project POV</h2> <p><a href="https://seanmcgary.com/posts/how-to-structure-a-nodejs-express-projehtml">How to structure a Node.js Express project : Sean McGary 20160327</a></p> <p>Embrace the Majestic Monolith - at least to start :</p> <ul> <li>All of your code is in one place</li> <li>Everyone on your team can find things easily</li> <li>No npm dependency management hell</li> </ul> <p>Example writing a RESTful API service built on top of PostgreSQL.</p> <p>Three different layers : Models, lib, and services.</p> <p>Data model is simple : each “company” can have n many “users” associated.</p> <p>The directory structure :</p> <pre><code>.
├── index.js
├── lib
│   ├── company
│   │   └── index.js
│   └── user
│       └── index.js
├── models
│   ├── company.js
│   └── user.js
├── routes
│   └── account
│       └── index.js
└── services
    └── account
        └── index.js</code></pre><p>The models schema :</p> <pre><code>user
----------
- id
- name
- email
- password
- company_id


company
----------
- id
- name


user (1) --&gt; (1) company
company (1) --&gt; (n) user</code></pre><h3 id="title-model">model</h3> <p><a href="http://docs.sequelizejs.com/en/lateshtml">sequelize</a> (featureful and powerfuly ORM)</p> <p>Your models can express relationships and are used to build sets of data to eventually send to the end user.</p> <h3 id="title-lib">lib</h3> <p>This is where we start to actually interact with our models.</p> <p>Create a corresponding file for each model that will wrap basic CRUD operations of a model.</p> <p>So if we want to list all the users for a company we write a <code>lib/user/index.js</code> file implementing a <code>listUsersForCompany</code> function.</p> <h3 id="title-services">services</h3> <p>They take different model-level modules and perform some combination of actions.</p> <p>We want to write a registration system for our application. When a user registers, you take their name, email, and<br>password, but you also need to create a company profile which could potentially have more users down the road.</p> <p>One company per user, many users per company. Being that a user depends on the existence of a company, we’re going to<br>transactionally create the two together to illustrate how a service would work.</p> <p>So we create a createUser function in <code>lib/user/index.js</code> and a <code>createCompany</code> function in <code>lib/company/index.js</code>.</p> <p>Then a <code>registerUserAndCompany</code> function wires everything in a <code>services/account/index.js</code> file using sequelize to make<br>it transactional.</p> <h2 id="title-entity-pov">entity POV</h2> <p>Example writing a messenger class in <code>C#</code>. </p> <p>It is a classic interface implemented by a class :</p> <pre><code class="lang-csharp">public interface IMessenger
{
    bool SendMessage();
    void HandleMessage();
    IMessage ComposeMessage();
}

public class Messenger : IMessenger
{
    public bool SendMessage() {}
    public void HandleMessage() {}
    public IMessage ComposeMessage() {}</code></pre> <p>In JavaScript we use functional style so we split each function in a separated file (no shared state<br>so there is no need to keep them in the same file)</p> <pre><code>messenger
    __tests__    
        composeMessage.test.js
        handleMessage.test.js
        sendMessage.test.js
    composeMessage.js
    handleMessage.js
    sendMessage.js
    index.js // this file combines them all together</code></pre></article></body></html>