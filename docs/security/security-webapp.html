<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui"><meta name="robots" content="none"><title>marlou knowledge base</title><link href="/github-markdown.d098492d.css" rel="stylesheet" media="all"><link href="/main.cb64a04a.css" rel="stylesheet" media="all"><link href="/github.51c27d45.css" rel="stylesheet"><script src="/docs.a0c71561.js"></script></head><body><article class="markdown-body"><h1 id="title-security-webapp">security webapp</h1> <h2 id="title-top-10-owasp-10-risques-de-sécurité-les-plus-critiques">Top 10 OWASP (10 risques de sécurité les plus critiques)</h2> <h3 id="title-1---injection">1 - Injection</h3> <p>SQL, LDAP, XPath, Parseur XML, …</p> <h4 id="title-exemple-avec-sql">Exemple avec SQL</h4> <p>Saisir dans un champ de saisie de mot de passe :</p> <pre><code>e&#39; or &#39;1&#39; = &#39;1</code></pre><h4 id="title-exemple-avec-xml">Exemple avec XML</h4> <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
    &lt;!DOCTYPE foo [
        &lt;!ELEMENT foo ANY &gt;
        &lt;!ELEMENT xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;
    &lt;foo&gt;&lt;&amp;xxe;&lt;/foo&gt;</code></pre><h3 id="title-2---violation-de-gestion-dauthentification-et-de-session">2 - Violation de gestion d’authentification et de session</h3> <p>L’authentification devrait être déléguée à un service tiers (Kerberos, OAuth, JWT, …)</p> <p>La session devrait être gérée via un cookie :</p> <pre><code>set-cookie:MonCookie=&quot;XXXX&quot;;Version=1;Secure;HttpOnly</code></pre><h3 id="title-3---exposition-de-données-sensibles">3 - Exposition de données sensibles</h3> <p>Protection par cryptographie.</p> <p>Analyse des données (stockées ou pas)</p> <p>Mot de passe : <code>bcrypt</code>, <code>PBKDF2</code>, <code>scrypt</code> (hash solo trop faible)</p> <h3 id="title-4---cross-site-scripting-xss">4 - Cross-Site Scripting (XSS)</h3> <p><a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">Cross-site Scripting (XSS) : owasp.org</a></p> <blockquote> <p>Cross-site scripting attacks may occur anywhere that possibly malicious users are allowed to post unregulated material to a trusted web site for the consumption of other valid users.</p> <p>The most common example can be found in bulletin-board web sites which provide web based mailing list-style functionality. </p> </blockquote> <p><a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">XSS (Cross Site Scripting) Prevention Cheat Sheet : owasp.org</a></p> <p>AngularJS gère en natif ce problème (sanitize).</p> <p><a href="https://html5sec.org/">Vectors making use of HTML5 features</a></p> <h3 id="title-5---références-directes-non-sécurisées">5 - références directes non sécurisées</h3> <pre><code>http://example.com/app/accountInfo?acct=notmyacct</code></pre><p>Pour taper sur un autre compte par exemple.</p> <p>Autre exemple, usage d’autoincrements SQL comme ID REST.</p> <p>Applicativement il faut s’assurer qu’un user ne reçoivent que les données auxquelles il a accès.</p> <p>Remplacer également les id SQL par des uuid.</p> <h3 id="title-6---mauvaise-config-secu">6 - mauvaise config secu</h3> <p>Taf des devops. Config OS, middleware, réseau, remplacement des mdp par défaut, etc …</p> <p>Question dev attention aux logs.</p> <h3 id="title-7---manque-de-contrôle-daccès-au-niveau-fonctionnel">7 - Manque de contrôle d’accès au niveau fonctionnel</h3> <p>RBAC à impl. Un user lambda ne doit pas accéder à l’administration de l’app.</p> <h3 id="title-8---falsification-de-requête-interdite-csrf">8 - Falsification de requête interdite (CSRF)</h3> <ul> <li>vérifier que la requête est “Same Origin” (headers standards)</li> <li>config &amp; impl CORS</li> <li>utiliser un token spécifique (Double cookie defense via XSRF-TOKEN)</li> </ul> <p>Exemple d’attaque :</p> <ul> <li><em>user</em> se connecte sur le site de sa banque utilisant un cookie pour gérer la session</li> <li><em>user</em> effectue quelques actions (check des comptes etc …)</li> <li><em>user</em> <strong>ne se delog pas</strong></li> <li><em>user</em> clique sur un lien lolcat reçu en mail. La page web chargée effectue un call sur le site<br>de la banque de <em>user</em> pour effectuer une transaction. Si CORS n’est pas configuré par la banque<br>alors le navigateur transmettra le cookie de session toujours valide avec le call du site frauduleux<br>et sa transaction sera acceptée.</li> </ul> <p>CORS configuration is <strong>server-side</strong>.</p> <p>A server using <code>&quot;Access-Control-Allow-Origin: *&quot;</code> allows all domains, it is <strong>very bad</strong>.</p> <p><a href="http://stackoverflow.com/questions/12001269/what-are-the-security-risks-of-setting-access-control-allow-origin">What are the security risks of setting Access-Control-Allow-Origin? : stackoverflow.com</a></p> <blockquote> <p>By responding with <code>Access-Control-Allow-Origin: *</code>, the requested resource allows sharing with every origin. This basically means that any site can send an XHR request to your site and access the server’s response which would not be the case if you hadn’t implemented this CORS response.</p> </blockquote> <blockquote> <p>So any site can make a request to your site on behalf of their visitors and process its response. If you have something implemented like an authentication or authorization scheme that is based on something that is automatically provided by the browser (cookies, cookie-based sessions, etc.), the requests triggered by the third party sites will use them too.</p> </blockquote> <h3 id="title-9---utilisation-de-composants-avec-des-vulnérabilités-connues">9 - Utilisation de composants avec des vulnérabilités connues</h3> <p>OWASP publie un composant MAVEN nommé <a href="https://www.owasp.org/index.php/OWASP_Dependency_Check"><code>dependency-check-maven</code></a> pour check les vulnérabilités de son projet par ex.</p> <p><a href="https://techbeacon.com/13-tools-checking-security-risk-open-source-dependencies-0">13 tools for checking the security risk of open-source dependencies</a></p> <h3 id="title-10---redirections-et-renvois-non-validés">10 - redirections et renvois non validés</h3> <pre><code>http://www.example.com/redirect.jsp?url=evil.com</code></pre><p>Par exemple si on permet aux users la saisie de liens (forum par ex), difficile de valider le lien de redirection.</p> <h2 id="title-autres-attaques">autres attaques</h2> <h3 id="title-redos">ReDoS</h3> <p><a href="https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS">Regular expression Denial of Service - ReDoS</a></p> <p>En fonction du pattern de la regex et de l’input donnée par l’utilisateur, il est possible de générer un cout CPU disproportionné. S’il y a plusieurs serveurs qui se passent la data et qu’ils checkent tous la data avec une regex, l’attaque peut toucher plusieurs machines. Contrairement à une DDoS classique dont le but est de noyer le serveur sous les requêtes, il s’agit ici de noyer le(s) serveur(s) sous le cout de calcul CPU.</p> <p>Exemple de ReDoS <a href="https://github.com/moment/moment/issues/4163">sur moment.js</a>.</p> <h2 id="title-ressources">ressources</h2> <p><a href="https://www.owasp.org/index.php/Main_Page">OWASP : the free and open software security community</a></p> <p><a href="https://www.youtube.com/watch?v=qjR-BW5EG0c">Protéger son application web des risques de sécurité les plus critiques (Pascal Abaziou) Devoxx2017</a></p> </article></body></html>